<!DOCTYPE html>
<html>
<head>

    <title>dategridtaps.html</title>

    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta charset="UTF-8">
    <title>管理端</title>
    <link rel="stylesheet" type="text/css" href="/common/css/wu.css" />
    <link rel="stylesheet" type="text/css" href="/common/css/icon.css" />
    <!-- 引入EasyUI的样式文件-->
    <link rel="stylesheet" href="/common/jquery-easyui-1.5.3/themes/default/easyui.css" type="text/css"/>
    <!-- 引入EasyUI的图标样式文件-->
    <!-- <link rel="stylesheet" href="/common/jquery-easyui-1.5.3/themes/icon.css" type="text/css"/>-->

    <!-- 引入JQuery -->
    <script type="text/javascript" src="/common/jquery-easyui-1.5.3/jquery.min.js"></script>
    <!-- 引入EasyUI -->
    <script type="text/javascript" src="/common/jquery-easyui-1.5.3/jquery.easyui.min.js"></script>
    <!-- 引入EasyUI的中文国际化js，让EasyUI支持中文 -->
    <script type="text/javascript" src="/common/jquery-easyui-1.5.3/locale/easyui-lang-zh_CN.js"></script>
    <!-- 引入EasyUI的样式文件-->
    <script type="text/javascript" src="/common/js/common.js"></script>
</head>
<body class="easyui-layout">
<!-- begin of header -->
<div class="wu-header" data-options="region:'north',border:false,split:true">
    <div class="wu-header-left">
        <h1>汇编语言竞赛管理系统</h1>
    </div>
    <div class="wu-header-right">
        <p><strong class="easyui-tooltip" title="2条未读消息">admin</strong>，欢迎您！</p>
        <p><a href="#">安全退出</a></p>
    </div>
</div>
<!-- end of header -->
<div class="wu-sidebar" data-options="region:'west',split:true,border:true,title:'导航菜单'">
    <div class="easyui-accordion" data-options="border:false,fit:true">
        <div title="竞赛管理" data-options="iconCls:'icon-application-form-edit',selected:true" style="overflow:auto;padding:10px;">
            <ul class="easyui-tree" id="contestTree">
                <li>竞赛信息管理</li>
                <li>分配评委</li>
                <li class="tree-node tree-node-selected">分数统计</li>
                <li>作品管理</li>
            </ul>
        </div>
        <div title="用户管理" data-options="iconCls:'icon-application-form-edit'," style="padding:10px;">
            <ul class="easyui-tree">
                <li>学生信息管理</li>
                <li>评委信息管理</li>
                <li>添加管理员</li>
            </ul>
        </div>
    </div>
</div>
<!-- begin of footer -->
<div class="wu-footer" data-options="region:'south',border:true,split:true">
    &copy; 2013 Wu All Rights Reserved
</div>
<div class="wu-main" data-options="region:'center'">
    <div class="easyui-tabs" data-options="fit:true,border:false">
        <div title="分数统计   ">
            <table id="contestList" toolbar="#toolbar" url="/man/json/contest/list" pagination="true"
                   style="width:600px;height:200px"></table>
        </div>
    </div>
    <div id="toolbar">

        <a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="add()">New</a>
        <a href="#" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="del()">Destroy</a>


        <span>竞赛 ID:</span>
        <input id="conId" style="line-height:26px;border:1px solid #ccc">

        <span>竞赛 题目:</span>
        <input id="conTitle" style="line-height:26px;border:1px solid #ccc">
        <span>竞赛状态:</span>
        <select id="status" style="line-height:26px;border:1px solid #ccc">
            <option value="3">正在打分</option>
            <option value="4" selected>打分完成</option>
            <option value="5">已结束</option>
        </select>
        <span>统计分数:</span>
        <select id="scoreStatus">
            <option value="0" selected>未统计</option>
            <option value="1">已统计</option>
        </select>
        <a href="#" class="easyui-linkbutton" plain="true" onclick="doSearch()">Search</a>
    </div>
</div>

<!--对话框-->
<div id="addContestModel" class="easyui-dialog" style="display: none;padding:5px;width:1000px;height:60%; "
     title="添加竞赛" iconCls="icon-ok"
     toolbar="#dlg-toolbar" buttons="#add-buttons">
    <form id="addContestForm" action="/man/json/contest/addOrUpdate" method="post">
        <table style="border-collapse: separate;border-spacing: 0px 10px;">
            <tr>
                <td class="tdName">题目:</td>
                <td><input name="title" type="text"></td>
            </tr>
            <tr>
                <td class="tdName">竞赛要求:</td>
                <td><textarea name="summary" maxlength="1000" required cols="50" rows="5"
                              placeholder="请输入少于500字的简介"></textarea></td>
            </tr>
            <tr>
                <td class="tdName">竞赛起始时间:</td>
                <td><input name="startDateStr" type="text" placeholder="2018-03-18"> - <input name="endDateStr"
                                                                                              type="text"
                                                                                              placeholder="2018-03-18">
                </td>
            </tr>
            <tr>
                <td class="tdName">报名起始时间:</td>
                <td><input name="enrollStartDateStr" type="text" placeholder="2018-03-18"/> - <input
                        name="enrollEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
            <tr>
                <td class="tdName">评分起始时间:</td>
                <td><input name="scoreStartDateStr" type="text" placeholder="2018-03-18"> - <input
                        name="scoreEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
            <tr>
                <td class="tdName">作品提交结束时间:</td>
                <td><input name="worksEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
        </table>
    </form>
</div>
<div id="add-buttons" style="display: none;overflow: hidden;">
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-ok" onclick="saveContest('add')">Ok</a>
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-cancel" onclick="closeModel()">Cancel</a>
</div>
<!--编辑对话框-->
<div id="editContestModel" class="easyui-dialog" style="display: none;padding:5px;width:1000px;height:60%; "
     title="编辑竞赛" iconCls="icon-ok"
     toolbar="#dlg-toolbar" buttons="#edit-buttons">
    <form id="editContestForm" action="/man/json/contest/addOrUpdate" method="post">
        <table style="border-collapse: separate;border-spacing: 0px 10px;">
            <tr>
                <td><input type="hidden" name="cid" id="cid"/></td>
            </tr>
            <tr>
                <td class="tdName">题目:</td>
                <td><input id="title" name="title" type="text"></td>
            </tr>
            <tr>
                <td class="tdName">竞赛要求:</td>
                <td><textarea id="summary" name="summary" maxlength="1000" required cols="50" rows="5"
                              placeholder="请输入少于500字的简介"></textarea></td>
            </tr>
            <tr>
                <td class="tdName">竞赛起始时间:</td>
                <td><input id="startDateStr" name="startDateStr" type="text" placeholder="2018-03-18"> - <input
                        id="endDateStr" name="endDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
            <tr>
                <td class="tdName">报名起始时间:</td>
                <td><input id="enrollStartDateStr" name="enrollStartDateStr" type="text" placeholder="2018-03-18"/> -
                    <input id="enrollEndDateStr" name="enrollEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
            <tr>
                <td class="tdName">评分起始时间:</td>
                <td><input id="scoreStartDateStr" name="scoreStartDateStr" type="text" placeholder="2018-03-18"> -
                    <input id="scoreEndDateStr" name="scoreEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
            <tr>
                <td class="tdName">作品提交结束时间:</td>
                <td><input id="worksEndDateStr" name="worksEndDateStr" type="text" placeholder="2018-03-18"></td>
            </tr>
        </table>
    </form>
</div>
<div id="edit-buttons" style="display: none;overflow: hidden;">
    <a href="javascript:void(0)" id="okButton" class="easyui-linkbutton" iconCls="icon-ok"
       onclick="saveContest('edit')">Ok</a>
    <a href="javascript:void(0)" id="calcelButton" class="easyui-linkbutton" iconCls="icon-cancel"
       onclick="closeModel()">Cancel</a>
</div>
</body>
<script>
    //关闭对话框
    function closeModel() {
        $("#editContestModel").dialog("close");
        $("#addContestModel").dialog("close");

    }

    //显示对话框
    function add() {
        $("#addContestModel").dialog("open");
    }


    //查询
    function doSearch() {
        var cId = $("#conId").val();
        var cTitle = $("#conTitle").val();
        var status = $("#status").val();
        var scoreStatus = $("#scoreStatus").val();
        var searchParam = {"cid": cId, "title": cTitle,"status":status,"scoreStatus":scoreStatus};

        $('#contestList').datagrid('load', {
            queryParam: JSON.stringify(searchParam)
        });
    }
</script>
<script type="text/javascript">
    $(function () {
        //关闭对话框
        debugger
        $("#addContestModel").dialog("close");
        $("#editContestModel").dialog("close");
        //初始化表格，双击事件
        queryList();
        $("#contestList").datagrid({
            //双击事件
            onDblClickRow: function (index, row) {
                debugger
                var startDate = new Date(row.startDate).Format("yyyy-MM-dd");
                var endDate = new Date(row.endDate).Format("yyyy-MM-dd");
                var enrollStartDate = new Date(row.enrollStartDate).Format("yyyy-MM-dd");
                var enrollEndDate = new Date(row.enrollEndDate).Format("yyyy-MM-dd");
                var scoreStartDate = new Date(row.scoreStartDate).Format("yyyy-MM-dd");
                var scoreEndDate = new Date(row.scoreEndDate).Format("yyyy-MM-dd");
                var worksEndDate = new Date(row.worksEndDate).Format("yyyy-MM-dd");

                $("#cid").val(row.cid);
                $("#title").val(row.title);
                $("#summary").val(row.summary);
                $("#startDateStr").val(startDate);
                $("#endDateStr").val(endDate);
                $("#enrollStartDateStr").val(enrollStartDate);
                $("#enrollEndDateStr").val(enrollEndDate);
                $("#scoreStartDateStr").val(scoreStartDate);
                $("#scoreEndDateStr").val(scoreEndDate);
                $("#worksEndDateStr").val(worksEndDate);
                $("#editContestModel").dialog("open");
            }
        });


    });

    $(function () {
        $('#contestTree').tree({
            onClick: function(node){
                debugger
                if("竞赛信息管理" == node.text){
                    window.location.href="/man/html/admin/contestList";
                }
                else if("分配评委" == node.text){
                    window.location.href="/man/html/admin/allotRater";
                }
                else if("分数统计" == node.text){
                    window.location.href="/man/html/admin/soreStatistic";
                }
                else if("作品管理" == node.text){

                }
                alert(node.text);
            }
        });
    });

    //查询列表
    function queryList() {

        $('#contestList').datagrid({
            url: '/man/json/contest/list',
            title: '竞赛列表',
            iconCls: 'icon-save',
            pagination: true,
            pageSize: 10,
            pageList: [10, 20],
            fit: true,//使表格自适应
            fitColumns: true,//使得表格中所有的列宽相加等于自适应的宽度、也就是浏览器改变大小的时候下方会不会出现滚动条、一般只有在列较少的时候使用
            nowrap: false,//表格中的文字可以换行、默认是false、不能换行、这样在文字很多的时候就看不到全部：使用真实的数据去测试
            border: false,
            idFeild: 'cid',  //标识、会记录我们选中项的id、不一定是id、通常使用主键
            sortName: 'cid', //设置默认排序时的 字段（必须是field中的一个字段）
            sortOrder: 'asc', //是按照升序还是降序排序   但是仅仅添加这两个字段并不会自动排序、这样写的意义就是前台会自动的向后台传递两个参数：sort order,我们可以在后台查询记录的时候进行排序
            columns: [[
                {   field:"",
                    title: '编号',
                    checkbox: true
                },
                {
                    field: 'cid',
                    title: '编号',
                    width: "5%",
                }, {
                    field: 'title',
                    title: '题目',
                    width: "15%",
                }, {
                    field: 'summary',
                    title: '简介',
                    width: "25%",
                },
                {
                    field: 'startEndTime',
                    title: '竞赛时间',
                    width: "15%",

                },
                {
                    field: 'scoreTime',
                    title: '打分时间',
                    width: "15%",

                },
                {
                    field: "status",
                    title: "竞赛状态",
                    width: '10%',
                    formatter: statusFormat
                },
                {
                    field: "scoreStatus",
                    title: "操作",
                    formatter: operateFormatter
                }

            ]]

        });
    }

    function statusFormat(val, row) {
        if (val == "0") {
            return '未开始';
        }
        else if (val == "1") {
            return '比赛已启动'
        }
        else if (val == "2") {
            return '开始报名';
        }
        else if (val == "3") {
            return '正在打分';
        }
        else if (val == "4") {
            return '打分已结束';
        } else {
            return '比赛结束';
        }
    }

    function operateFormatter(value, row, index) {
        if (value == "0") {
            return '<button type="button " class="RoleOfdelete btn btn-primary  btn-sm" >分数统计</button>';

        }
        if (value == "1") {
            return '<span>已统计完成</span>';

        }
    }

</script>
</html>